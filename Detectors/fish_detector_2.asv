
close all
clear

% shrink_video
% videoLabeler
% combine_gtruths

net = alexnet;

load hero_truth_51
data = objectDetectorTrainingData(gTruth, 'SamplingFactor', 1);

options = trainingOptions('adam', 'Shuffle', 'every-epoch', 'MaxEpochs', 50, 'MiniBatchSize', 16, 'InitialLearnRate', 0.00001, 'executionenvironment', 'gpu');
trainedDetector = trainFastRCNNObjectDetector(data, net, options);
save('trainedDetector', 'trainedDetector')

test_fish_detector
